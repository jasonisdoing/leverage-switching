# μ‹μ¤ν… μ•„ν‚¤ν…μ² (System Architecture)

## 1. ν”„λ΅μ νΈ κ°μ”
μ΄ ν”„λ΅μ νΈλ” **λ‚μ¤λ‹¥ λ λ²„λ¦¬μ§€ μ¤μ„μΉ­ μ „λµ**μ„ μλ™μΌλ΅ μµμ ν™”ν•κ³  λ§¤λ§¤ μ¶”μ²μ„ μƒμ„±ν•λ” μ‹μ¤ν…μ…λ‹λ‹¤.
ν•µμ‹¬ κµ¬μ„±μ”μ†:
- **νλ‹(Tuning)**: κ³Όκ±° λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ μµμ μ νλΌλ―Έν„°λ¥Ό νƒμƒ‰
- **λ°±ν…μ¤νΈ(Backtest)**: μ „λµμ κ³Όκ±° μ„±κ³Όλ¥Ό κ²€μ¦
- **μ¶”μ²(Recommendation)**: λ°±ν…μ¤νΈ κ²°κ³Όλ¥Ό λ°”νƒ•μΌλ΅ ν„μ¬ ν¬μ§€μ… κ²°μ •

## 2. νμΌ κµ¬μ΅°

```
π“ nasdaq-leverage-switching/
β”β”€β”€ π“„ tune.py              # νλ‹ μ‹¤ν–‰ μ§„μ…μ  (μ‹μ¥ μΈμ μ§€μ›)
β”β”€β”€ π“„ backtest.py          # λ°±ν…μ¤νΈ μ‹¤ν–‰ μ§„μ…μ 
β”β”€β”€ π“„ recommend.py         # μ¶”μ² μ‹¤ν–‰ μ§„μ…μ 
β”β”€β”€ π“ config/              # μ‹μ¥λ³„ μ„¤μ • νμΌ μ €μ¥μ†
β”‚   β”β”€β”€ π“„ us.json          # λ―Έκµ­ μ‹μ¥ μ„¤μ •
β”‚   β””β”€β”€ π“„ kor.json          # ν•κµ­ μ‹μ¥ μ„¤μ •
β”β”€β”€ π“ logic/
β”‚   β”β”€β”€ π“ backtest/        # λ°±ν…μ¤νΈ ν•µμ‹¬ λ΅μ§
β”‚   β”‚   β”β”€β”€ runner.py       # λ°±ν…μ¤νΈ μ—”μ§„
β”‚   β”‚   β”β”€β”€ data.py         # λ°μ΄ν„° λ‹¤μ΄λ΅λ“ (yfinance/pykrx)
β”‚   β”‚   β”β”€β”€ signals.py      # μ‹κ·Έλ„ κ³„μ‚° λ° ν¬μ§€μ… κ²°μ •
β”‚   β”‚   β””β”€β”€ settings.py     # μ„¤μ • λ΅λ”© λ° ν¬λ§· μ •κ·ν™”
β”‚   β””β”€β”€ π“ tune/            # νλ‹ λ΅μ§
β”‚       β””β”€β”€ runner.py       # λ³‘λ ¬ νλ‹ λ° λ°μ΄ν„° κ°€μ©μ„± μ²΄ν¬
β”β”€β”€ π“ zresults/            # μ‹¤ν–‰ κ²°κ³Ό μ €μ¥μ†
β”‚   β”β”€β”€ π“ us/              # λ―Έκµ­ μ‹μ¥ λ΅κ·Έ
β”‚   β””β”€β”€ π“ kor/             # ν•κµ­ μ‹μ¥ λ΅κ·Έ
```

## 3. λ¨λ“ μ—­ν• 

### μ§„μ…μ  μ¤ν¬λ¦½νΈ
| νμΌ | μ—­ν•  |
|------|------|
| `tune.py` | νλΌλ―Έν„° μµμ ν™” μ‹¤ν–‰. κ²°κ³Όλ¥Ό `config/*.json`μ— μ—…λ°μ΄νΈ |
| `backtest.py` | μ „λµ μ„±κ³Ό κ²€μ¦. μƒμ„Έ λ¦¬ν¬νΈ λ° λ΅κ·Έ μƒμ„± |
| `recommend.py` | μµκ·Ό λ°μ΄ν„°λ¥Ό λ°”νƒ•μΌλ΅ μ¤λμ ν¬μ§€μ… μ¶”μ² |

### ν•µμ‹¬ λ΅μ§ (`logic/backtest/`)
| νμΌ | μ—­ν•  |
|------|------|
| `runner.py` | λ°±ν…μ¤νΈ μ—”μ§„. **ν•κµ­ μ‹μ¥(KRW)**κ³Ό **λ―Έκµ­ μ‹μ¥(USD)** ν†µν™” ν¬λ§· μλ™ μ „ν™ |
| `data.py` | `yfinance`(λ―Έκµ­) λ° `pykrx`(ν•κµ­)λ¥Ό ν†µν• λ°μ΄ν„° μμ§‘ |
| `signals.py` | QQQ/KODEXλ‚μ¤λ‹¥100 κΈ°λ° λ“λ΅λ‹¤μ΄ κ³„μ‚° |
| `settings.py` | μ‹ κµ¬ν• μ„¤μ • ν¬λ§· νΈν™ λ° λ°μ΄ν„° μ •κ·ν™” |

## 4. λ°μ΄ν„° νλ¦„

```mermaid
graph TD
    A[config/market.json] --> B[backtest/runner.py]
    C1[yfinance - US] --> B
    C2[pykrx - KOR] --> B
    B --> D{κ²°κ³Ό μ§‘κ³„}
    D --> E[backtest.py: λ¦¬ν¬νΈ μƒμ„±]
    D --> F[recommend.py: μ¤λμ λ§¤λ§¤ μ‹ νΈ]
    D --> G[tune.py: μµμ  νλΌλ―Έν„° μ„ λ³„]
    G --> A
```

1. **μ„¤μ • λ΅λ“**: `config/*.json`μ—μ„ μ‹μ¥λ³„ νλΌλ―Έν„° μ½κΈ°
2. **λ°μ΄ν„° μμ§‘**: `yfinance` λλ” `pykrx`λ¥Ό ν†µν•΄ μ‹κ·Έλ„, κ³µκ²©, λ°©μ–΄ μμ‚° μ£Όκ°€ λ‹¤μ΄λ΅λ“
3. **λ°±ν…μ¤νΈ μ‹¤ν–‰**: μΌλ³„ ν¬μ§€μ… λ° μ†μµ κ³„μ‚°
4. **κ²°κ³Ό μ¶λ ¥**:
   - `backtest.py`: μ „μ²΄ κΈ°κ°„ λ¦¬ν¬νΈ μƒμ„±
   - `recommend.py`: μµκ·ΌμΌ κΈ°μ¤€ λ§¤λ§¤ ν¬μ§€μ… μ¶”μ²
   - `tune.py`: λ¨λ“  μ΅°ν•© λΉ„κµ ν›„ μµμ  νλΌλ―Έν„°λ¥Ό `config/*.json`μ— μ—…λ°μ΄νΈ
