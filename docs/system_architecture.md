# μ‹μ¤ν… μ•„ν‚¤ν…μ² (System Architecture)

## 1. ν”„λ΅μ νΈ κ°μ”
μ΄ ν”„λ΅μ νΈλ” **λ‚μ¤λ‹¥ λ λ²„λ¦¬μ§€ μ¤μ„μΉ­ μ „λµ**μ„ μλ™μΌλ΅ μµμ ν™”ν•κ³  λ§¤λ§¤ μ¶”μ²μ„ μƒμ„±ν•λ” μ‹μ¤ν…μ…λ‹λ‹¤.
ν•µμ‹¬ κµ¬μ„±μ”μ†:
- **νλ‹(Tuning)**: κ³Όκ±° λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ μµμ μ νλΌλ―Έν„°λ¥Ό νƒμƒ‰
- **λ°±ν…μ¤νΈ(Backtest)**: μ „λµμ κ³Όκ±° μ„±κ³Όλ¥Ό κ²€μ¦
- **μ¶”μ²(Recommendation)**: λ°±ν…μ¤νΈ κ²°κ³Όλ¥Ό λ°”νƒ•μΌλ΅ ν„μ¬ ν¬μ§€μ… κ²°μ •

## 2. νμΌ κµ¬μ΅°

```
π“ nasdaq-leverage-switching/
β”β”€β”€ π“„ tune.py              # νλ‹ μ‹¤ν–‰ μ§„μ…μ 
β”β”€β”€ π“„ backtest.py          # λ°±ν…μ¤νΈ μ‹¤ν–‰ μ§„μ…μ 
β”β”€β”€ π“„ recommend.py         # μ¶”μ² μ‹¤ν–‰ μ§„μ…μ  (λ°±ν…μ¤νΈ κ²°κ³Ό ν™μ©)
β”β”€β”€ π“„ settings.json        # νλΌλ―Έν„° μ„¤μ • νμΌ
β”β”€β”€ π“ logic/
β”‚   β”β”€β”€ π“ backtest/        # λ°±ν…μ¤νΈ ν•µμ‹¬ λ΅μ§
β”‚   β”‚   β”β”€β”€ runner.py       # λ°±ν…μ¤νΈ μ—”μ§„
β”‚   β”‚   β”β”€β”€ data.py         # λ°μ΄ν„° λ‹¤μ΄λ΅λ“/μ „μ²λ¦¬
β”‚   β”‚   β”β”€β”€ signals.py      # μ‹κ·Έλ„ κ³„μ‚° λ° ν¬μ§€μ… κ²°μ •
β”‚   β”‚   β””β”€β”€ settings.py     # μ„¤μ • λ΅λ”©
β”‚   β””β”€β”€ π“ tune/            # νλ‹ λ΅μ§
β”‚       β””β”€β”€ runner.py       # λ³‘λ ¬ νλ‹ μ‹¤ν–‰
β”β”€β”€ π“ docs/                # λ¬Έμ„
β”β”€β”€ π“ zresults/            # μ‹¤ν–‰ κ²°κ³Ό λ΅κ·Έ μ €μ¥
β””β”€β”€ π“ znotes/              # μ‚¬μ©μ λ©”λ¨
```

## 3. λ¨λ“ μ—­ν• 

### μ§„μ…μ  μ¤ν¬λ¦½νΈ
| νμΌ | μ—­ν•  |
|------|------|
| `tune.py` | νλΌλ―Έν„° μµμ ν™” μ‹¤ν–‰. κ²°κ³Όλ¥Ό `settings.json`μ— μ €μ¥ |
| `backtest.py` | μ „λµ μ„±κ³Ό κ²€μ¦. μƒμ„Έ λ¦¬ν¬νΈ μ¶λ ¥ |
| `recommend.py` | **λ°±ν…μ¤νΈ κ²°κ³Όμ λ§μ§€λ§‰ λ‚ **μ„ μ¤λμ μ¶”μ²μΌλ΅ μ¶λ ¥ |

### ν•µμ‹¬ λ΅μ§ (`logic/backtest/`)
λ¨λ“  λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ `logic/backtest/` ν΄λ”μ— ν†µν•©λμ–΄ μμµλ‹λ‹¤.

| νμΌ | μ—­ν•  |
|------|------|
| `runner.py` | λ°±ν…μ¤νΈ μ—”μ§„ (μΌλ³„ μ†μµ, CAGR, MDD κ³„μ‚°) |
| `data.py` | yfinanceλ¥Ό ν†µν• μ£Όκ°€/ν™μ¨ λ‹¤μ΄λ΅λ“ |
| `signals.py` | Drawdown κ³„μ‚° λ° `pick_target()` ν•¨μ |
| `settings.py` | `settings.json` λ΅λ”© λ° κ²€μ¦ |

> **μ„¤κ³„ μ›μΉ™**: `recommend.py`λ” λ…λ¦½μ μΈ μ¶”μ² λ΅μ§ μ—†μ΄, `backtest.py`μ™€ λ™μΌν• λ΅μ§μ„ μ‚¬μ©ν•©λ‹λ‹¤.
> λ°±ν…μ¤νΈμ λ§μ§€λ§‰ λ‚  κ²°κ³Όκ°€ κ³§ "μ¤λμ μ¶”μ²"μ΄ λ©λ‹λ‹¤.

## 4. λ°μ΄ν„° νλ¦„

```mermaid
graph LR
    A[settings.json] --> B[backtest/runner.py]
    C[yfinance] --> B
    B --> D{κ²°κ³Ό}
    D --> E[backtest.py: μ „μ²΄ λ¦¬ν¬νΈ]
    D --> F[recommend.py: λ§μ§€λ§‰ λ‚ λ§]
    D --> G[tune.py: CAGR λΉ„κµ]
```

1. **μ„¤μ • λ΅λ“**: `settings.json`μ—μ„ νλΌλ―Έν„° μ½κΈ°
2. **λ°μ΄ν„° μμ§‘**: yfinanceλ΅ QQQ, TQQQ, λ°©μ–΄μμ‚° μ£Όκ°€ λ‹¤μ΄λ΅λ“
3. **λ°±ν…μ¤νΈ μ‹¤ν–‰**: μΌλ³„ ν¬μ§€μ… λ° μ†μµ κ³„μ‚°
4. **κ²°κ³Ό μ¶λ ¥**:
   - `backtest.py`: μ „μ²΄ κΈ°κ°„ λ¦¬ν¬νΈ
   - `recommend.py`: λ§μ§€λ§‰ λ‚  ν¬μ§€μ…λ§ μ¶”μ¶
   - `tune.py`: μ—¬λ¬ νλΌλ―Έν„° μ΅°ν•©μ CAGR λΉ„κµ
